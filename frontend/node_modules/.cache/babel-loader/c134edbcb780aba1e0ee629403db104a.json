{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Josh\\\\Desktop\\\\top-100-movies\\\\top-100-movies\\\\frontend\\\\src\\\\components\\\\dashboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { UserContext } from \"../context/UserContext\";\nimport MovieCard from \"../components/movieCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Dashboard = props => {\n  _s();\n\n  const [userContext, setUserContext] = useContext(UserContext);\n  const [followingMovies, setFollowingMovies] = useState([]);\n  const bgImageStyle = {\n    backgroundImage: 'url(\\'\\https://images.unsplash.com/photo-1592780828756-c418d71faa1f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80\\')',\n    height: \"40vh\"\n  };\n\n  function movieInUserFavorites(movieId) {\n    var favoriteMovies = Object.entries(userContext.details.favorite_movies);\n\n    for (var i = 0; i < favoriteMovies.length; i++) {\n      if (favoriteMovies[i][1].id == movieId) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function showFollowerMovies() {\n    var followsMovies = [];\n\n    if (userContext.details != null) {\n      //Get followers\n      var follows = userContext.details.following; //Loop through followers and get data\n\n      for (var i = 0; i < follows.length; i++) {\n        //Look at top 3 movies from followers\n        fetch(process.env.REACT_APP_API_ENDPOINT + \"users/\" + follows[i], {\n          method: \"GET\",\n          credentials: \"include\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${userContext.token}`\n          }\n        }).then(async response => {\n          if (response.ok) {\n            const data = await response.json();\n\n            if (Object.entries(data.favorite_movies).length > 0) {\n              var movieRanks = Object.keys(data.favorite_movies).sort();\n              var movieCount = 0;\n              movieRanks.forEach(rank => {\n                if (movieCount < 3) {\n                  var currentMovie = data.favorite_movies[movieRanks[i]];\n                  console.log(currentMovie); //Make a movie card for each and push\n\n                  var movieImage = currentMovie.poster_path ? \"https://image.tmdb.org/t/p/w185/\" + currentMovie.poster_path : \"./NoMovieImage.jpg\";\n                  followsMovies.push( /*#__PURE__*/_jsxDEV(MovieCard, {\n                    movie: {\n                      currentMovie,\n                      \"image\": movieImage,\n                      \"movieAlreadyAdded\": movieInUserFavorites(currentMovie.id)\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 58,\n                    columnNumber: 38\n                  }, this));\n                  movieCount++;\n                }\n              });\n            }\n\n            console.log(\"FOLLOWS MOVIES\");\n            console.log(followsMovies);\n            return followsMovies;\n          } else {\n            if (response.status === 401) {\n              console.log(\"COULDNT FETCH PROFILE DETAILS\"); //window.location.reload()\n            }\n          }\n        });\n      }\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"contianer-fluid rounded\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container  bg-image pt-5\",\n      style: bgImageStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \" text-light rounded\",\n        children: \"Welcome to Top 100 Movies\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-light pb-5 pt-3\",\n        children: \"This is a place where you can rank your top 100 movies.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), userContext.details == null ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row mt-5 mb-3 rounded justify-content-center align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Already have an account?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          className: \"btn btn-primary\",\n          to: \"/login\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"New here?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          className: \"btn btn-primary\",\n          to: \"/register\",\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-center\",\n        children: \"People You Follow Like These Movies\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }, this), showFollowerMovies()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Dashboard, \"VCLFOPV1WIEDqLRxXkdDtxopZM4=\");\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"sources":["C:/Users/Josh/Desktop/top-100-movies/top-100-movies/frontend/src/components/dashboard.js"],"names":["React","useState","useContext","useEffect","Link","UserContext","MovieCard","Dashboard","props","userContext","setUserContext","followingMovies","setFollowingMovies","bgImageStyle","backgroundImage","height","movieInUserFavorites","movieId","favoriteMovies","Object","entries","details","favorite_movies","i","length","id","showFollowerMovies","followsMovies","follows","following","fetch","process","env","REACT_APP_API_ENDPOINT","method","credentials","headers","Authorization","token","then","response","ok","data","json","movieRanks","keys","sort","movieCount","forEach","rank","currentMovie","console","log","movieImage","poster_path","push","status"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect} from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { UserContext } from \"../context/UserContext\";\r\nimport MovieCard from \"../components/movieCard\";\r\n\r\n\r\nconst Dashboard = props => {\r\n  const [userContext, setUserContext] = useContext(UserContext);\r\n  const [followingMovies, setFollowingMovies] = useState([]);\r\n\r\n  const bgImageStyle = {\r\n    backgroundImage: 'url(\\'\\https://images.unsplash.com/photo-1592780828756-c418d71faa1f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80\\')',\r\n    height: \"40vh\"\r\n  }\r\n\r\n  function movieInUserFavorites(movieId){\r\n    var favoriteMovies = Object.entries(userContext.details.favorite_movies);\r\n    for(var i = 0; i < favoriteMovies.length; i++){\r\n      if(favoriteMovies[i][1].id == movieId){\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n\r\n  function showFollowerMovies(){\r\n    var followsMovies = [];\r\n    if(userContext.details != null){\r\n      //Get followers\r\n      var follows = userContext.details.following;\r\n\r\n      //Loop through followers and get data\r\n      for(var i = 0; i < follows.length; i++){\r\n        //Look at top 3 movies from followers\r\n        fetch(process.env.REACT_APP_API_ENDPOINT +\"users/\"+follows[i], {\r\n          method:\"GET\",\r\n          credentials:\"include\",\r\n          headers: {\r\n            \"Content-Type\":\"application/json\",\r\n            Authorization: `Bearer ${userContext.token}`\r\n          }\r\n        })\r\n        .then(async response =>{\r\n          if(response.ok){\r\n            const data = await response.json();\r\n            if(Object.entries(data.favorite_movies).length > 0){\r\n              var movieRanks = Object.keys(data.favorite_movies).sort();\r\n              var movieCount = 0;\r\n\r\n              movieRanks.forEach((rank) => {\r\n                if(movieCount < 3){\r\n                  var currentMovie = data.favorite_movies[movieRanks[i]];\r\n                  console.log(currentMovie);\r\n                  //Make a movie card for each and push\r\n                  var movieImage = currentMovie.poster_path ? \"https://image.tmdb.org/t/p/w185/\" + currentMovie.poster_path : \"./NoMovieImage.jpg\"\r\n\r\n                  followsMovies.push(<MovieCard movie={{currentMovie,\"image\":movieImage,\"movieAlreadyAdded\":movieInUserFavorites(currentMovie.id)}}/>);\r\n                  movieCount++;\r\n                }\r\n              });\r\n            }\r\n            console.log(\"FOLLOWS MOVIES\");\r\n            console.log(followsMovies);\r\n            return(followsMovies);\r\n          }\r\n          else{\r\n            if(response.status === 401){\r\n              console.log(\"COULDNT FETCH PROFILE DETAILS\");\r\n              //window.location.reload()\r\n            }\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"contianer-fluid rounded\">\r\n      <div className=\"container  bg-image pt-5\" style={bgImageStyle}>\r\n        <h1 className=\" text-light rounded\">Welcome to Top 100 Movies</h1>\r\n        <h3 className=\"text-light pb-5 pt-3\">This is a place where you can rank your top 100 movies.</h3>\r\n      </div>\r\n      {\r\n        userContext.details == null ? (\r\n\r\n            <div className=\"row mt-5 mb-3 rounded justify-content-center align-items-center\">\r\n              <div className=\"col-md-6 text-center\">\r\n                <p>Already have an account?</p>\r\n                <Link className=\"btn btn-primary\" to=\"/login\">Login</Link>\r\n              </div>\r\n              <div className=\"col-md-6 text-center\">\r\n                <p>New here?</p>\r\n                <Link className=\"btn btn-primary\" to=\"/register\">Register</Link>\r\n              </div>\r\n            </div>\r\n        )\r\n        :\r\n        (\r\n          <div className=\"row\">\r\n            <h3 className=\"text-center\">People You Follow Like These Movies</h3>\r\n            {\r\n              showFollowerMovies()\r\n            }\r\n          </div>\r\n        )\r\n      }\r\n      </div>\r\n  )\r\n};\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}